!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","react","react-dom"],e):e(t.ReachRouter={},t.React,t.ReactDOM)}(this,function(t,e,n){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,n=n&&n.hasOwnProperty("default")?n.default:n;var r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function i(t,e){return t(e={exports:{}},e.exports),e.exports}function a(t){return function(){return t}}var u=function(){};u.thatReturns=a,u.thatReturnsFalse=a(!1),u.thatReturnsTrue=a(!0),u.thatReturnsNull=a(null),u.thatReturnsThis=function(){return this},u.thatReturnsArgument=function(t){return t};var c=u;var s=function(t,e,n,r,o,i,a,u){if(!t){var c;if(void 0===e)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=[n,r,o,i,a,u],p=0;(c=new Error(e.replace(/%s/g,function(){return s[p++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},p=c,l=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;(function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}})()&&Object.assign;var d="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",v=i(function(t){t.exports=function(){function t(t,e,n,r,o,i){i!==d&&s(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return n.checkPropTypes=c,n.PropTypes=n,n}()}),m=function(t,e,n,r,o,i,a,u){if(!t){var c;if(void 0===e)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=[n,r,o,i,a,u],p=0;(c=new Error(e.replace(/%s/g,function(){return s[p++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},y="__global_unique_id__",g=function(){return r[y]=(r[y]||0)+1},b=i(function(t,n){n.__esModule=!0;var r=a(e),o=a(v),i=a(g);a(p);function a(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var l=1073741823;n.default=r.default.createContext||function(t,n){var r,a,p="__create-react-context-"+(0,i.default)()+"__",f=function(t){function e(){var n,r,o,i;u(this,e);for(var a=arguments.length,s=Array(a),p=0;p<a;p++)s[p]=arguments[p];return n=r=c(this,t.call.apply(t,[this].concat(s))),r.emitter=(o=r.props.value,i=[],{on:function(t){i.push(t)},off:function(t){i=i.filter(function(e){return e!==t})},get:function(){return o},set:function(t,e){o=t,i.forEach(function(t){return t(o,e)})}}),c(r,n)}return s(e,t),e.prototype.getChildContext=function(){var t;return(t={})[p]=this.emitter,t},e.prototype.componentWillReceiveProps=function(t){if(this.props.value!==t.value){var e=this.props.value,r=t.value,o=void 0;((i=e)===(a=r)?0!==i||1/i==1/a:i!=i&&a!=a)?o=0:(o="function"==typeof n?n(e,r):l,0!=(o|=0)&&this.emitter.set(t.value,o))}var i,a},e.prototype.render=function(){return this.props.children},e}(e.Component);f.childContextTypes=((r={})[p]=o.default.object.isRequired,r);var h=function(e){function n(){var t,r;u(this,n);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return t=r=c(this,e.call.apply(e,[this].concat(i))),r.state={value:r.getValue()},r.onUpdate=function(t,e){0!=((0|r.observedBits)&e)&&r.setState({value:r.getValue()})},c(r,t)}return s(n,e),n.prototype.componentWillReceiveProps=function(t){var e=t.observedBits;this.observedBits=void 0===e||null===e?l:e},n.prototype.componentDidMount=function(){this.context[p]&&this.context[p].on(this.onUpdate);var t=this.props.observedBits;this.observedBits=void 0===t||null===t?l:t},n.prototype.componentWillUnmount=function(){this.context[p]&&this.context[p].off(this.onUpdate)},n.prototype.getValue=function(){return this.context[p]?this.context[p].get():t},n.prototype.render=function(){return(t=this.props.children,Array.isArray(t)?t[0]:t)(this.state.value);var t},n}(e.Component);return h.contextTypes=((a={})[p]=o.default.object,a),{Provider:f,Consumer:h}},t.exports=n.default});o(b);var w=o(i(function(t,n){n.__esModule=!0;var r=i(e),o=i(b);function i(t){return t&&t.__esModule?t:{default:t}}n.default=r.default.createContext||o.default,t.exports=n.default}));function _(){var t=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==t&&void 0!==t&&this.setState(t)}function E(t){this.setState(function(e){var n=this.constructor.getDerivedStateFromProps(t,e);return null!==n&&void 0!==n?n:null}.bind(this))}function P(t,e){try{var n=this.props,r=this.state;this.props=t,this.state=e,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}_.__suppressDeprecationWarning=!0,E.__suppressDeprecationWarning=!0,P.__suppressDeprecationWarning=!0;var O=function(t,e){return t.substr(0,e.length)===e},x=function(t,e){for(var n=void 0,r=void 0,o=e.split("?")[0],i=T(o),a=""===i[0],u=F(t),c=0,s=u.length;c<s;c++){var p=!1,l=u[c].route;if(l.default)r={route:l,params:{},uri:e};else{for(var f=T(l.path),h={},d=Math.max(i.length,f.length),v=0;v<d;v++){var y=f[v],g=i[v];if("*"===y){h["*"]=i.slice(v).map(decodeURIComponent).join("/");break}if(void 0===g){p=!0;break}var b=j.exec(y);if(b&&!a){-1===W.indexOf(b[1])||m(!1);var w=decodeURIComponent(g);h[b[1]]=w}else if(y!==g){p=!0;break}}if(!p){n={route:l,params:h,uri:"/"+i.slice(0,v).join("/")};break}}}return n||r||null},C=function(t,e){if(O(t,"/"))return t;var n=t.split("?"),r=n[0],o=n[1],i=e.split("?")[0],a=T(r),u=T(i);if(""===a[0])return D(i,o);if(!O(a[0],".")){var c=u.concat(a).join("/");return D(("/"===i?"":"/")+c,o)}for(var s=u.concat(a),p=[],l=0,f=s.length;l<f;l++){var h=s[l];".."===h?p.pop():"."!==h&&p.push(h)}return D("/"+p.join("/"),o)},S=function(t,e){return"/"+T(t).map(function(t){var n=j.exec(t);return n?e[n[1]]:t}).join("/")},j=/^:(.+)/,R=function(t){return j.test(t)},U=function(t,e){return{route:t,score:t.default?0:T(t.path).reduce(function(t,e){return t+=4,!function(t){return""===t}(e)?R(e)?t+=2:!function(t){return"*"===t}(e)?t+=3:t-=5:t+=1,t},0),index:e}},F=function(t){return t.map(U).sort(function(t,e){return t.score<e.score?1:t.score>e.score?-1:t.index-e.index})},T=function(t){return t.replace(/(^\/+|\/+$)/g,"").split("/")},D=function(t,e){return t+(e?"?"+e:"")},W=["uri","path"],M=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},k=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},A=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},I=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n},q=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},N=function(t){return k({},t.location,{state:t.history.state,key:t.history.state&&t.history.state.key||"initial"})},B=function(t,e){var n=[],r=N(t),o=!1,i=function(){};return{get location(){return r},get transitioning(){return o},_onTransitionComplete:function(){o=!1,i()},listen:function(e){n.push(e);var o=function(){r=N(t),e()};return t.addEventListener("popstate",o),function(){t.removeEventListener("popstate",o),n=n.filter(function(t){return t!==e})}},navigate:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=a.state,c=a.replace,s=void 0!==c&&c;u=k({},u,{key:Date.now()+""});try{o||s?t.history.replaceState(u,null,e):t.history.pushState(u,null,e)}catch(n){t.location[s?"replace":"assign"](e)}r=N(t),o=!0;var p=new Promise(function(t){return i=t});return n.forEach(function(t){return t()}),p}}},L=function(){var t=0,e=[{pathname:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",search:""}],n=[];return{get location(){return e[t]},addEventListener:function(t,e){},removeEventListener:function(t,e){},history:{get entries(){return e},get index(){return t},get state(){return n[t]},pushState:function(r,o,i){var a=i.split("?"),u=a[0],c=a[1],s=void 0===c?"":c;t++,e.push({pathname:u,search:s}),n.push(r)},replaceState:function(r,o,i){var a=i.split("?"),u=a[0],c=a[1],s=void 0===c?"":c;e[t]={pathname:u,search:s},n[t]=r}}}},V=B(!("undefined"==typeof window||!window.document||!window.document.createElement)?window:L()),K=V.navigate,$=n.unstable_deferredUpdates;void 0===$&&($=function(t){return t()});var H=function(t,e){var n=w(e);return n.Consumer.displayName=t+".Consumer",n.Provider.displayName=t+".Provider",n},Y=H("Location"),z=function(t){var n=t.children;return e.createElement(Y.Consumer,null,function(t){return t?n(t):e.createElement(G,null,n)})},G=function(t){function n(){var e,r;M(this,n);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=r=q(this,t.call.apply(t,[this].concat(i))),r.state={context:r.getContext(),refs:{unlisten:null}},q(r,e)}return A(n,t),n.prototype.getContext=function(){var t=this.props.history;return{navigate:t.navigate,location:t.location}},n.prototype.componentDidCatch=function(t,e){if(!ct(t))throw t;(0,this.props.history.navigate)(t.uri,{replace:!0})},n.prototype.componentDidUpdate=function(t,e){e.context.location!==this.state.context.location&&this.props.history._onTransitionComplete()},n.prototype.componentDidMount=function(){var t=this,e=this.state.refs,n=this.props.history;e.unlisten=n.listen(function(){Promise.resolve().then(function(){$(function(){t.unmounted||t.setState(function(){return{context:t.getContext()}})})})})},n.prototype.componentWillUnmount=function(){var t=this.state.refs;this.unmounted=!0,t.unlisten()},n.prototype.render=function(){var t=this.state.context,n=this.props.children;return e.createElement(Y.Provider,{value:t},"function"==typeof n?n(t):n||null)},n}(e.Component);G.defaultProps={history:V};var J=H("Base",{baseuri:"/",basepath:"/"}),Q=function(t){return e.createElement(J.Consumer,null,function(n){return e.createElement(z,null,function(r){return e.createElement(X,k({},n,r,t))})})},X=function(t){function n(){return M(this,n),q(this,t.apply(this,arguments))}return A(n,t),n.prototype.render=function(){var t=this.props,n=t.location,r=t.navigate,o=t.basepath,i=t.primary,a=t.children,u=(t.baseuri,t.component),c=void 0===u?"div":u,s=I(t,["location","navigate","basepath","primary","children","baseuri","component"]),p=e.Children.map(a,ht(o)),l=n.pathname,f=x(p,l);if(f){var h=f.params,d=f.uri,v=f.route,m=f.route.value;o=v.default?o:v.path.replace(/\*$/,"");var y=k({},h,{uri:d,location:n,navigate:function(t,e){return r(C(t,d),e)}}),g=e.cloneElement(m,y,m.props.children?e.createElement(Q,{primary:i},m.props.children):void 0),b=i?tt:c,w=i?k({uri:d,location:n,component:c},s):s;return e.createElement(J.Provider,{value:{baseuri:d,basepath:o}},e.createElement(b,w,g))}return null},n}(e.PureComponent);X.defaultProps={primary:!0};var Z=H("Focus"),tt=function(t){var n=t.uri,r=t.location,o=t.component,i=I(t,["uri","location","component"]);return e.createElement(Z.Consumer,null,function(t){return e.createElement(rt,k({},i,{component:o,requestFocus:t,uri:n,location:r}))})},et=!0,nt=0,rt=function(t){function n(){var e,r;M(this,n);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=r=q(this,t.call.apply(t,[this].concat(i))),r.state={},r.requestFocus=function(t){r.state.shouldFocus||t.focus()},q(r,e)}return A(n,t),n.getDerivedStateFromProps=function(t,e){if(null==e.uri)return k({shouldFocus:!0},t);var n=t.uri!==e.uri,r=e.location.pathname!==t.location.pathname&&t.location.pathname===t.uri;return k({shouldFocus:n||r},t)},n.prototype.componentDidMount=function(){nt++,this.focus()},n.prototype.componentWillUnmount=function(){0===--nt&&(et=!0)},n.prototype.componentDidUpdate=function(t,e){t.location!==this.props.location&&this.state.shouldFocus&&this.focus()},n.prototype.focus=function(){var t=this.props.requestFocus;t?t(this.node):et?et=!1:this.node.focus()},n.prototype.render=function(){var t=this,n=this.props,r=(n.children,n.style),o=(n.requestFocus,n.role),i=void 0===o?"group":o,a=n.component,u=void 0===a?"div":a,c=(n.uri,n.location,I(n,["children","style","requestFocus","role","component","uri","location"]));return e.createElement(u,k({style:k({outline:"none"},r),tabIndex:"-1",role:i,ref:function(e){return t.node=e}},c),e.createElement(Z.Provider,{value:this.requestFocus},this.props.children))},n}(e.Component);!function(t){var e=t.prototype;if(!e||!e.isReactComponent)throw new Error("Can only polyfill class components");if("function"!=typeof t.getDerivedStateFromProps&&"function"!=typeof e.getSnapshotBeforeUpdate)return t;var n=null,r=null,o=null;if("function"==typeof e.componentWillMount?n="componentWillMount":"function"==typeof e.UNSAFE_componentWillMount&&(n="UNSAFE_componentWillMount"),"function"==typeof e.componentWillReceiveProps?r="componentWillReceiveProps":"function"==typeof e.UNSAFE_componentWillReceiveProps&&(r="UNSAFE_componentWillReceiveProps"),"function"==typeof e.componentWillUpdate?o="componentWillUpdate":"function"==typeof e.UNSAFE_componentWillUpdate&&(o="UNSAFE_componentWillUpdate"),null!==n||null!==r||null!==o){var i=t.displayName||t.name,a="function"==typeof t.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+i+" uses "+a+" but also contains the following legacy lifecycles:"+(null!==n?"\n  "+n:"")+(null!==r?"\n  "+r:"")+(null!==o?"\n  "+o:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"==typeof t.getDerivedStateFromProps&&(e.componentWillMount=_,e.componentWillReceiveProps=E),"function"==typeof e.getSnapshotBeforeUpdate){if("function"!=typeof e.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");e.componentWillUpdate=P;var u=e.componentDidUpdate;e.componentDidUpdate=function(t,e,n){var r=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:n;u.call(this,t,e,r)}}}(rt);var ot=function(){},it=e.forwardRef;void 0===it&&(it=function(t){return t});var at=it(function(t,n){var r=t.innerRef,o=I(t,["innerRef"]);return e.createElement(J.Consumer,null,function(t){t.basepath;var i=t.baseuri;return e.createElement(z,null,function(t){var a=t.location,u=t.navigate,c=o.to,s=o.state,p=o.replace,l=o.getProps,f=void 0===l?ot:l,h=I(o,["to","state","replace","getProps"]),d=C(c,i),v=a.pathname===d,m=O(a.pathname,d);return e.createElement("a",k({ref:n||r,"aria-current":v?"page":void 0},h,f({isCurrent:v,isPartiallyCurrent:m,href:d,location:a}),{href:d,onClick:function(t){h.onClick&&h.onClick(t),dt(t)&&(t.preventDefault(),u(d,{state:s,replace:p}))}}))})})});function ut(t){this.uri=t}var ct=function(t){return t instanceof ut},st=function(t){throw new ut(t)},pt=function(t){function e(){return M(this,e),q(this,t.apply(this,arguments))}return A(e,t),e.prototype.componentDidMount=function(){var t=this.props,e=t.navigate,n=t.to,r=(t.from,t.replace),o=void 0===r||r,i=t.state,a=(t.noThrow,I(t,["navigate","to","from","replace","state","noThrow"]));Promise.resolve().then(function(){e(S(n,a),{replace:o,state:i})})},e.prototype.render=function(){var t=this.props,e=(t.navigate,t.to),n=(t.from,t.replace,t.state,t.noThrow),r=I(t,["navigate","to","from","replace","state","noThrow"]);return n||st(S(e,r)),null},e}(e.Component),lt=function(t){return e.createElement(z,null,function(n){return e.createElement(pt,k({},n,t))})},ft=function(t){return t.replace(/(^\/+|\/+$)/g,"")},ht=function(t){return function(e){var n,r,o;if(e.props.path||e.props.default||e.type===lt||m(!1),e.type!==lt||e.props.from&&e.props.to||m(!1),e.type===lt&&(n=e.props.from,r=e.props.to,o=function(t){return R(t)},T(n).filter(o).sort().join("/")!==T(r).filter(o).sort().join("/"))&&m(!1),e.props.default)return{value:e,default:!0};var i=e.type===lt?e.props.from:e.props.path,a="/"===i?t:ft(t)+"/"+ft(i);return{value:e,default:e.props.default,path:e.props.children?ft(a)+"/*":a}}},dt=function(t){return!t.defaultPrevented&&0===t.button&&!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)};t.Link=at,t.Location=z,t.LocationProvider=G,t.Match=function(t){var n=t.path,r=t.children;return e.createElement(J.Consumer,null,function(t){var o=t.baseuri;return e.createElement(z,null,function(t){var e=t.navigate,i=t.location,a=function(t,e){return x([{path:t}],e)}(C(n,o),i.pathname);return r({navigate:e,location:i,match:a?k({},a.params,{uri:a.uri,path:n}):null})})})},t.Redirect=lt,t.Router=Q,t.ServerLocation=function(t){var n=t.url,r=t.children;return e.createElement(Y.Provider,{value:{location:{pathname:n},navigate:function(){throw new Error("You can't call navigate on the server.")}}},r)},t.createHistory=B,t.createMemorySource=L,t.isRedirect=ct,t.navigate=K,t.redirectTo=st,Object.defineProperty(t,"__esModule",{value:!0})});
